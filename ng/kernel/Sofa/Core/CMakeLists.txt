cmake_minimum_required(VERSION 3.1)
project(Sofa.Core)

find_package(Sofa.DefaultType)
find_package(Sofa.Helper.Rendering)
find_package(Sofa.Helper.Mesh)

set(HEADER_FILES
    src/sofa/core/BaseMapping.h
    src/sofa/core/BaseState.h
    src/sofa/core/BehaviorModel.h
    src/sofa/core/CategoryLibrary.h
    src/sofa/core/CollisionElement.h
    src/sofa/core/CollisionModel.h
    src/sofa/core/ComponentLibrary.h
    src/sofa/core/ConstraintParams.h
    src/sofa/core/DataEngine.h
    src/sofa/core/DataTracker.h
    src/sofa/core/ExecParams.h
    src/sofa/core/Mapping.h
    src/sofa/core/Mapping.inl
    src/sofa/core/MechanicalParams.h
    src/sofa/core/Multi2Mapping.h
    src/sofa/core/Multi2Mapping.inl
    src/sofa/core/MultiMapping.h
    src/sofa/core/MultiMapping.inl
    src/sofa/core/MultiVecId.h
    src/sofa/core/ObjectFactory.h
    src/sofa/core/SofaLibrary.h
    src/sofa/core/State.h
    src/sofa/core/State.inl
    src/sofa/core/VecId.h
    src/sofa/core/behavior/BaseAnimationLoop.h
    src/sofa/core/behavior/BaseConstraint.h
    src/sofa/core/behavior/BaseConstraintCorrection.h
    src/sofa/core/behavior/BaseConstraintSet.h
    src/sofa/core/behavior/BaseController.h
    src/sofa/core/behavior/BaseForceField.h
    src/sofa/core/behavior/BaseInteractionConstraint.h
    src/sofa/core/behavior/BaseInteractionForceField.h
    src/sofa/core/behavior/BaseInteractionProjectiveConstraintSet.h
    src/sofa/core/behavior/BaseLMConstraint.h
    src/sofa/core/behavior/BaseMass.h
    src/sofa/core/behavior/BaseMechanicalState.h
    src/sofa/core/behavior/BaseProjectiveConstraintSet.h
    src/sofa/core/behavior/BaseRotationFinder.h
    src/sofa/core/behavior/BaseVectorOperations.h
    src/sofa/core/behavior/Constraint.h
    src/sofa/core/behavior/Constraint.inl
    src/sofa/core/behavior/ConstraintCorrection.h
    src/sofa/core/behavior/ConstraintCorrection.inl
    src/sofa/core/behavior/ConstraintSolver.h
    src/sofa/core/behavior/ForceField.h
    src/sofa/core/behavior/ForceField.inl
    src/sofa/core/behavior/LMConstraint.h
    src/sofa/core/behavior/LMConstraint.inl
    src/sofa/core/behavior/LinearSolver.h
    src/sofa/core/behavior/Mass.h
    src/sofa/core/behavior/Mass.inl
    src/sofa/core/behavior/MechanicalState.h
    src/sofa/core/behavior/MixedInteractionConstraint.h
    src/sofa/core/behavior/MixedInteractionConstraint.inl
    src/sofa/core/behavior/MixedInteractionForceField.h
    src/sofa/core/behavior/MixedInteractionForceField.inl
    src/sofa/core/behavior/MultiMatrix.h
    src/sofa/core/behavior/MultiMatrixAccessor.h
    src/sofa/core/behavior/MultiVec.h
    src/sofa/core/behavior/OdeSolver.h
    src/sofa/core/behavior/PairInteractionConstraint.h
    src/sofa/core/behavior/PairInteractionConstraint.inl
    src/sofa/core/behavior/PairInteractionForceField.h
    src/sofa/core/behavior/PairInteractionForceField.inl
    src/sofa/core/behavior/PairInteractionProjectiveConstraintSet.h
    src/sofa/core/behavior/PairInteractionProjectiveConstraintSet.inl
    src/sofa/core/behavior/ProjectiveConstraintSet.h
    src/sofa/core/behavior/ProjectiveConstraintSet.inl
    src/sofa/core/behavior/RotationMatrix.h
    src/sofa/core/collision/BroadPhaseDetection.h
    src/sofa/core/collision/CollisionAlgorithm.h
    src/sofa/core/collision/CollisionGroupManager.h
    src/sofa/core/collision/Contact.h
    src/sofa/core/collision/ContactManager.h
    src/sofa/core/collision/Detection.h
    src/sofa/core/collision/DetectionOutput.h
    src/sofa/core/collision/Intersection.h
    src/sofa/core/collision/Intersection.inl
    src/sofa/core/collision/IntersectorFactory.h
    src/sofa/core/collision/NarrowPhaseDetection.h
    src/sofa/core/collision/Pipeline.h
    src/sofa/core/core.h
    src/sofa/core/config.h
    src/sofa/core/init.h
    src/sofa/core/loader/BaseLoader.h
    src/sofa/core/loader/ImageLoader.h
    src/sofa/core/loader/Material.h
    src/sofa/core/loader/MeshLoader.h
    src/sofa/core/loader/PrimitiveGroup.h
    src/sofa/core/loader/SceneLoader.h
    src/sofa/core/loader/VoxelLoader.h
    src/sofa/core/objectmodel/AspectPool.h
    src/sofa/core/objectmodel/Base.h
    src/sofa/core/objectmodel/BaseClass.h
    src/sofa/core/objectmodel/BaseContext.h
    src/sofa/core/objectmodel/BaseData.h
    src/sofa/core/objectmodel/BaseLink.h
    src/sofa/core/objectmodel/BaseNode.h
    src/sofa/core/objectmodel/BaseObject.h
    src/sofa/core/objectmodel/BaseObjectDescription.h
    src/sofa/core/objectmodel/ClassInfo.h
    src/sofa/core/objectmodel/ConfigurationSetting.h
    src/sofa/core/objectmodel/Context.h
    src/sofa/core/objectmodel/ContextObject.h
    src/sofa/core/objectmodel/DDGNode.h
    src/sofa/core/objectmodel/Data.h
    src/sofa/core/objectmodel/DataFileName.h
    src/sofa/core/objectmodel/DetachNodeEvent.h
    src/sofa/core/objectmodel/Event.h
    src/sofa/core/objectmodel/GUIEvent.h
    src/sofa/core/objectmodel/HapticDeviceEvent.h
    src/sofa/core/objectmodel/JoystickEvent.h
    src/sofa/core/objectmodel/KeypressedEvent.h
    src/sofa/core/objectmodel/KeyreleasedEvent.h
    src/sofa/core/objectmodel/IdleEvent.h
    src/sofa/core/objectmodel/Link.h
    src/sofa/core/objectmodel/MouseEvent.h
    src/sofa/core/objectmodel/SPtr.h
    src/sofa/core/objectmodel/Tag.h
    src/sofa/core/topology/BaseMeshTopology.h
    src/sofa/core/topology/BaseTopology.h
    src/sofa/core/topology/BaseTopologyData.h
    src/sofa/core/topology/BaseTopologyEngine.h
    src/sofa/core/topology/BaseTopologyObject.h
    src/sofa/core/topology/TopologicalMapping.h
    src/sofa/core/topology/Topology.h
    src/sofa/core/topology/TopologyChange.h
    src/sofa/core/topology/TopologyElementHandler.h
    src/sofa/core/topology/TopologyHandler.h
    src/sofa/core/visual/DisplayFlags.h
    src/sofa/core/visual/DrawTool.h
    src/sofa/core/visual/Shader.h
    src/sofa/core/visual/VisualLoop.h
    src/sofa/core/visual/VisualManager.h
    src/sofa/core/visual/VisualModel.h
    src/sofa/core/visual/VisualParams.h
    src/sofa/core/logging/RichConsoleStyleMessageFormatter.h
    src/sofa/core/logging/PerComponentLoggingMessageHandler.h
)

set(SOURCE_FILES
    src/sofa/core/BaseMapping.cpp
    src/sofa/core/BaseState.cpp
    src/sofa/core/BehaviorModel.cpp
    src/sofa/core/CategoryLibrary.cpp
    src/sofa/core/CollisionModel.cpp
    src/sofa/core/ComponentLibrary.cpp
    src/sofa/core/ConstraintParams.cpp
    src/sofa/core/DataEngine.cpp
    src/sofa/core/DataTracker.cpp
    src/sofa/core/ExecParams.cpp
    src/sofa/core/Mapping.cpp
    src/sofa/core/MechanicalParams.cpp
    src/sofa/core/Multi2Mapping.cpp
    src/sofa/core/MultiMapping.cpp
    src/sofa/core/ObjectFactory.cpp
    src/sofa/core/# Plugin.cpp
    src/sofa/core/# PluginManager.cpp
    src/sofa/core/SofaLibrary.cpp
    src/sofa/core/State.cpp
    src/sofa/core/behavior/BaseAnimationLoop.cpp
    src/sofa/core/behavior/BaseConstraintSet.cpp
    src/sofa/core/behavior/BaseForceField.cpp
    src/sofa/core/behavior/BaseInteractionForceField.cpp
    src/sofa/core/behavior/BaseLMConstraint.cpp
    src/sofa/core/behavior/BaseMass.cpp
    src/sofa/core/behavior/BaseMechanicalState.cpp
    src/sofa/core/behavior/BaseProjectiveConstraintSet.cpp
    src/sofa/core/behavior/Constraint.cpp
    src/sofa/core/behavior/ConstraintCorrection.cpp
    src/sofa/core/behavior/ConstraintSolver.cpp
    src/sofa/core/behavior/ForceField.cpp
    src/sofa/core/behavior/LMConstraint.cpp
    src/sofa/core/behavior/LinearSolver.cpp
    src/sofa/core/behavior/Mass.cpp
    src/sofa/core/behavior/MechanicalState.cpp
    src/sofa/core/behavior/MixedInteractionConstraint.cpp
    src/sofa/core/behavior/MixedInteractionForceField.cpp
    src/sofa/core/behavior/MultiMatrix.cpp
    src/sofa/core/behavior/MultiMatrixAccessor.cpp
    src/sofa/core/behavior/OdeSolver.cpp
    src/sofa/core/behavior/PairInteractionConstraint.cpp
    src/sofa/core/behavior/PairInteractionForceField.cpp
    src/sofa/core/behavior/PairInteractionProjectiveConstraintSet.cpp
    src/sofa/core/behavior/ProjectiveConstraintSet.cpp
    src/sofa/core/collision/Contact.cpp
    src/sofa/core/collision/Intersection.cpp
    src/sofa/core/collision/Pipeline.cpp
    src/sofa/core/init.cpp
    src/sofa/core/loader/BaseLoader.cpp
    src/sofa/core/loader/MeshLoader.cpp
    src/sofa/core/loader/SceneLoader.cpp
    src/sofa/core/loader/VoxelLoader.cpp
    src/sofa/core/objectmodel/AspectPool.cpp
    src/sofa/core/objectmodel/Base.cpp
    src/sofa/core/objectmodel/BaseClass.cpp
    src/sofa/core/objectmodel/BaseContext.cpp
    src/sofa/core/objectmodel/BaseData.cpp
    src/sofa/core/objectmodel/BaseLink.cpp
    src/sofa/core/objectmodel/BaseNode.cpp
    src/sofa/core/objectmodel/BaseObject.cpp
    src/sofa/core/objectmodel/BaseObjectDescription.cpp
    src/sofa/core/objectmodel/ClassInfo.cpp
    src/sofa/core/objectmodel/ConfigurationSetting.cpp
    src/sofa/core/objectmodel/ContextObject.cpp
    src/sofa/core/objectmodel/Context.cpp
    src/sofa/core/objectmodel/DDGNode.cpp
    src/sofa/core/objectmodel/Data.cpp
    src/sofa/core/objectmodel/DataFileName.cpp
    src/sofa/core/objectmodel/DetachNodeEvent.cpp
    src/sofa/core/objectmodel/Event.cpp
    src/sofa/core/objectmodel/GUIEvent.cpp
    src/sofa/core/objectmodel/HapticDeviceEvent.cpp
    src/sofa/core/objectmodel/JoystickEvent.cpp
    src/sofa/core/objectmodel/KeypressedEvent.cpp
    src/sofa/core/objectmodel/KeyreleasedEvent.cpp
    src/sofa/core/objectmodel/MouseEvent.cpp
    src/sofa/core/objectmodel/IdleEvent.cpp
    src/sofa/core/objectmodel/Tag.cpp
    src/sofa/core/topology/BaseMeshTopology.cpp
    src/sofa/core/topology/BaseTopology.cpp
    src/sofa/core/topology/BaseTopologyObject.cpp
    src/sofa/core/topology/Topology.cpp
    src/sofa/core/topology/TopologyChange.cpp
    src/sofa/core/topology/TopologyElementHandler.cpp
    src/sofa/core/topology/TopologyHandler.cpp
    src/sofa/core/visual/Shader.cpp
    src/sofa/core/visual/DisplayFlags.cpp
    src/sofa/core/visual/VisualLoop.cpp
    src/sofa/core/visual/VisualManager.cpp
    src/sofa/core/visual/VisualModel.cpp
    src/sofa/core/visual/VisualParams.cpp
    src/sofa/core/logging/RichConsoleStyleMessageFormatter.cpp
    src/sofa/core/logging/PerComponentLoggingMessageHandler.cpp
)

if(Boost_thread_FOUND)
    list(APPEND HEADER_FILES objectmodel/AspectPool.h)
    list(APPEND SOURCE_FILES objectmodel/AspectPool.cpp)
endif()

add_library(${PROJECT_NAME} SHARED ${HEADER_FILES} ${SOURCE_FILES})
target_link_libraries(${PROJECT_NAME} PUBLIC Sofa.DefaultType Sofa.Helper.Rendering Sofa.Helper.Mesh)
target_include_directories(${PROJECT_NAME} PUBLIC "$<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/src/>")
set_target_properties(${PROJECT_NAME} PROPERTIES COMPILE_FLAGS "-DSOFA_BUILD_CORE")
set_target_properties(${PROJECT_NAME} PROPERTIES DEBUG_POSTFIX "_d")
set_target_properties(${PROJECT_NAME} PROPERTIES VERSION "${SOFAFRAMEWORK_VERSION}")

install(DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}/" DESTINATION "include/sofa/core"
        FILES_MATCHING PATTERN "*.h" PATTERN "*.inl")
